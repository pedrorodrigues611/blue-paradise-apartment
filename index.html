<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Blue Paradise Apartment by Hoperty</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary-color: #1B3F4B;
      --primary-hover: #16303a;
    }
    /* ========== CSS BASE ========= */
    body, h1, h2, h3, p, button, span, select {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }
    body {
      background-color: #f5f8f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      width: 100%;
      max-width: 900px;
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
      position: relative;
    }
    /* ========== Carrossel de imagens (imagem maior) ========== */
    .image-gallery {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      margin: auto;
    }
    .image-gallery .main-image img {
      width: 100%;
      display: block;
      border-radius: 10px;
    }
    .image-gallery button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background-color: rgba(27,63,75,0.8);
      color: #fff;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      font-size: 18px;
      border-radius: 50%;
      transition: background 0.3s;
    }
    .image-gallery .prev { left: 10px; }
    .image-gallery .next { right: 10px; }
    .image-gallery button:hover {
      background-color: var(--primary-hover);
    }
    /* ========== Conte√∫do em 2 colunas (Informa√ß√µes / Reserva) ========== */
    .content-wrapper {
      display: flex;
      gap: 20px;
      margin-top: 20px;
    }
    .left-column { flex: 2; }
    .right-column { flex: 1; }
    /* ========== Informa√ß√µes da Casa ‚Äì Descri√ß√£o e detalhes ========== */
    .description {
      color: var(--primary-color);
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    .description h1,
    .description h2,
    .description h3 {
      color: var(--primary-color);
    }
    .description p {
      font-size: 16px;
      line-height: 1.6;
      margin-bottom: 10px;
    }
    .details p {
      font-size: 16px;
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    /* Separadores com espa√ßamento extra */
    br + hr + br {
      /* garante espa√ßamento acima e abaixo do <hr> */
    }
    hr {
      border: 0;
      border-top: 1px solid #ccc;
    }
    /* ========== Comodidades ========== */
    .facilities {
      margin-bottom: 10px;
    }
    .facilities p {
      font-size: 16px;
      color: var(--primary-color);
    }
    .facilities button {
      background-color: var(--primary-color);
      color: #fff;
      border: none;
      padding: 8px 15px;
      cursor: pointer;
      border-radius: 5px;
      font-size: 14px;
      transition: background 0.3s;
    }
    .facilities button:hover { background-color: var(--primary-hover); }
    #amenities-list {
      display: none;
      margin-top: 10px;
      background: #f1f1f1;
      padding: 10px;
      border-radius: 5px;
    }
    /* ========== Regras da Casa (para n√£o partir frase no meio) ========== */
    .rules {
      display: flex;          /* permitir "embrulhar" as regras */
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 10px;
    }
    .rule-item {
      white-space: nowrap;    /* faz a frase ficar toda na mesma linha */
      background: #f1f1f1;
      border-radius: 5px;
      padding: 5px 10px;
    }
    /* ========== Calend√°rio (Disponibilidade) ========== */
    .calendar h3 {
      color: var(--primary-color);
      margin-bottom: 10px;
    }
    .calendar {
      text-align: center;
    }
    .calendar iframe {
      width: 100%;
      height: 400px;
      border: none;
      border-radius: 5px;
    }
    /* ========== Booking Container (Reserva) ========== */
    .booking-container {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      box-shadow: 0px 2px 8px rgba(0,0,0,0.1);
      padding: 20px;
      position: relative;
    }
    .booking-container .price {
      font-size: 22px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 15px;
    }
    /* Linha de inputs para data e n¬∫ de pessoas */
    .booking-inputs {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    .booking-input {
      flex: 1;
      display: flex;
      align-items: center;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background: #fafafa;
      cursor: pointer;
      transition: border-color 0.3s;
      position: relative; /* para manipular o select se necess√°rio */
    }
    .booking-input:hover { border-color: var(--primary-color); }
    .booking-input img {
      width: 20px;
      height: 20px;
      margin-right: 8px;
      pointer-events: none; /* para n√£o "bloquear" clique */
    }
    .booking-input span {
      font-size: 16px;
      color: #666;
      pointer-events: none;
    }
    /* Tornar o SELECT invis√≠vel e ocupar toda a √°rea, para clique funcionar em qualquer ponto */
    .booking-guests {
      position: relative;
    }
    .booking-guests select {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    /* ========== Date Picker Customizado ========== */
    .date-picker-container {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 10px;
      width: 300px;
      display: none;
      position: absolute;
      z-index: 999;
      bottom: 100%;
      left: 0;
      margin-bottom: 10px;
      box-shadow: 0px 4px 8px rgba(0,0,0,0.1);
    }
    .date-picker-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-weight: bold;
    }
    .nav-button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: var(--primary-color);
    }
    .date-picker-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      text-align: center;
    }
    .date-picker-day {
      width: 30px;
      height: 30px;
      line-height: 30px;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .date-picker-day:hover {
      background-color: #ddd;
    }
    /* Dias bloqueados: riscado, esbranqui√ßado, sem clique */
    .disabled-day {
      background-color: #eee;
      color: #999;
      text-decoration: line-through;
      cursor: not-allowed;
      pointer-events: none; /* n√£o clica */
    }
    .selected-day {
      background-color: var(--primary-color);
      color: #fff;
    }
    .range-day, .hover-range {
      background-color: var(--primary-color) !important;
      color: #fff !important;
    }
    /* Aviso de estadia m√≠nima ‚Äì width ajustada ao conte√∫do */
    #minNightsMessage {
      display: none;
      padding: 5px 10px;
      background: var(--primary-color);
      color: #fff;
      text-align: center;
      border-radius: 5px;
      font-size: 14px;
      position: absolute;
      white-space: nowrap;
    }
    /* ========== Resumo e Breakdown (Reserva) ========== */
    .resumo-container,
    .breakdown-container {
      margin-top: 15px;
      padding: 10px;
      background: #f1f1f1;
      border-radius: 6px;
      display: none;
    }
    .resumo-container p,
    .breakdown-container p {
      margin: 5px 0;
      font-size: 14px;
    }
    /* Link para "Ver detalhes / Ocultar" */
    .toggle-detalhes {
      display: inline-block;
      margin-top: 10px;
      color: var(--primary-color);
      cursor: pointer;
      text-decoration: underline;
      font-size: 14px;
    }
    /* Bot√£o Reservar */
    .reserve-btn {
      width: 100%;
      background-color: var(--primary-color);
      color: #fff;
      border: none;
      padding: 10px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 15px;
      border-radius: 5px;
      transition: background 0.3s;
    }
    .reserve-btn:hover { background-color: var(--primary-hover); }
  </style>
</head>
<body>
  <div class="container">
    <!-- Carrossel de imagens (imagem maior) -->
    <div class="image-gallery">
      <button class="prev">&#10094;</button>
      <div class="main-image">
        <img src="https://i.imgur.com/h9vIQpq.jpeg" alt="Blue Paradise Apartment">
      </div>
      <button class="next">&#10095;</button>
    </div>
    <!-- Divis√£o em 2 colunas: Informa√ß√µes da Casa (esquerda) e Reserva (direita) -->
    <div class="content-wrapper">
      <!-- Coluna Esquerda: Informa√ß√µes da Casa -->
      <div class="left-column">
        <div class="description">
          <h1>Blue Paradise Apartment by Hoperty</h1>
          <p>
            O Blue Paradise Apartment encontra-se localizado no Cani√ßo. Este apartamento √© novo, espa√ßoso e moderno, com muita luz natural, vista parcial para o mar e um amplo p√°tio.
          </p>
          <p>
            Est√° bem localizado: restaurantes, pastelarias e bares a poucos passos, praia a 5 minutos a p√©, Funchal a 10 minutos de carro e pr√≥ximo do aeroporto.<br>
            Supermercado e cafetaria no mesmo pr√©dio.
          </p>
        </div>
        <div class="details">
          <p>Funchal - 4 h√≥spedes - 2 quartos - 2 casas de banho</p>
          <br><hr><br>
          <div class="facilities">
            <p>üçΩ Cozinha &nbsp; üî• Forno &nbsp; üåø Jardim</p>
            <button id="show-amenities">Mostrar todas as 10 comodidades</button>
            <div id="amenities-list" style="display:none;">
              <p>‚úî Wi‚ÄëFi r√°pido &nbsp; ‚úî Ar Condicionado &nbsp; ‚úî M√°quina de Lavar</p>
              <p>‚úî Piscina &nbsp; ‚úî TV a Cabo &nbsp; ‚úî Estacionamento</p>
            </div>
          </div>
          <br><hr><br>
          <h2>Regras da casa</h2>
          <div class="rules">
            <div class="rule-item">‚úî Check-in: 15h</div>
            <div class="rule-item">‚úî Check-out: 11h</div>
            <div class="rule-item">‚úî Crian√ßas permitidas</div>
            <div class="rule-item">‚úî Beb√©s permitidos</div>
            <div class="rule-item">‚ùå Fumar n√£o permitido</div>
            <div class="rule-item">‚ùå Festas n√£o permitidas</div>
          </div>
          <br><hr><br>
          <div class="calendar">
            <h3>Disponibilidade</h3>
            <iframe src="https://calendar.google.com/calendar/embed?
src=c4qe8v081ip4g6hfb5v5i99j9jfafsfb%40import.calendar.google.com
&amp;src=gq3m477imq71fcv56kojh45833nphv7r%40import.calendar.google.com
&amp;ctz=Europe%2FLisbon" 
                    style="border: 0" 
                    width="100%" 
                    height="400" 
                    frameborder="0" 
                    scrolling="no">
            </iframe>
          </div>
        </div>
      </div>
      <!-- Coluna Direita: Container de Reserva -->
      <div class="right-column">
        <div class="booking-container">
          <div class="price">‚Ç¨120/noite</div>
          <!-- Linha de inputs: Data e N¬∫ de pessoas -->
          <div class="booking-inputs">
            <!-- Campo para selecionar datas -->
            <div class="booking-input" id="bookingDateInput">
              <img src="https://img.icons8.com/fluency/48/000000/calendar.png" alt="Calend√°rio">
              <span>Selecione datas</span>
            </div>
            <!-- Campo para selecionar n¬∫ de pessoas -->
            <div class="booking-input booking-guests" id="bookingGuestsInput">
              <img src="https://img.icons8.com/fluency-systems-regular/48/000000/user.png" alt="√çcone de pessoa">
              <select id="guests">
                <option value="1" selected>1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
              </select>
            </div>
          </div>
          <!-- Date Picker Customizado -->
          <div class="date-picker-container" id="customDatePicker"></div>
          <!-- Resumo (exibe datas e pre√ßo total) ‚Äì o total aparece numa row abaixo das datas -->
          <div class="resumo-container" id="resumoContainer">
            <p id="resumoText"></p>
            <span id="toggleDetalhes" class="toggle-detalhes">Ver detalhes</span>
          </div>
          <!-- Breakdown (detalhamento dos pre√ßos) -->
          <div class="breakdown-container" id="breakdownContainer">
            <p id="breakdownText"></p>
          </div>
          <!-- Bot√£o Reservar -->
          <button class="reserve-btn" id="reserveBtn" style="display:none;">Reservar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    /********************************************
     * SCRIPT BASE (Carrossel, Amenities)
     ********************************************/
    document.addEventListener("DOMContentLoaded", function() {
      // Carrossel de imagens
      let currentImageIndex = 0;
      const images = [
        "https://i.imgur.com/h9vIQpq.jpeg",
        "https://i.imgur.com/BgggDFV.jpeg",
        "https://imgur.com/Fe8ECNE.jpeg",
        "https://imgur.com/rVkhRc4.jpeg",
        "https://imgur.com/JpITN8m.jpeg"
      ];
      const mainImage = document.querySelector(".main-image img");
      const nextButton = document.querySelector(".next");
      const prevButton = document.querySelector(".prev");
      function updateImage() { mainImage.src = images[currentImageIndex]; }
      nextButton.addEventListener("click", function() {
        currentImageIndex = (currentImageIndex + 1) % images.length;
        updateImage();
      });
      prevButton.addEventListener("click", function() {
        currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
        updateImage();
      });
      
      // Comodidades
      const showAmenitiesBtn = document.getElementById("show-amenities");
      const amenitiesList = document.getElementById("amenities-list");
      showAmenitiesBtn.addEventListener("click", function() {
        amenitiesList.style.display = (amenitiesList.style.display === "none") ? "block" : "none";
      });
    });
    
    /****************************************************
     * L√ìGICA DAS DATAS OCUPADAS (Google Calendar)
     ****************************************************/
    const calendarId1 = "c4qe8v081ip4g6hfb5v5i99j9jfafsfb@import.calendar.google.com";
    const calendarId2 = "gq3m477imq71fcv56kojh45833nphv7r@import.calendar.google.com";
    const apiKey = "SUA_API_KEY"; // Substitua pela sua API Key
    
    async function getBookedDates() {
      let events = [];
      const urls = [
        `https://www.googleapis.com/calendar/v3/calendars/${calendarId1}/events?key=${apiKey}`,
        `https://www.googleapis.com/calendar/v3/calendars/${calendarId2}/events?key=${apiKey}`
      ];
      for (let url of urls) {
        let response = await fetch(url);
        let data = await response.json();
        if (data.items) {
          data.items.forEach(event => {
            if (event.start && event.start.date) {
              events.push(event.start.date);
            }
          });
        }
      }
      return events;
    }
    
    /****************************************************
     * DATE PICKER CUSTOMIZADO COM NAVEGA√á√ÉO E HIGHLIGHT DE INTERVALO
     ****************************************************/
    let currentCalendarYear, currentCalendarMonth;
    let currentHoveredDate = null;
    let selectedCheckin = null, selectedCheckout = null;
    let bookedDatesGlobal = [];
    let minNightsMessage;
    
    const bookingDateInput = document.getElementById("bookingDateInput");
    const datePickerContainer = document.getElementById("customDatePicker");
    const resumoContainer = document.getElementById("resumoContainer");
    const resumoText = document.getElementById("resumoText");
    const toggleDetalhes = document.getElementById("toggleDetalhes");
    const breakdownContainer = document.getElementById("breakdownContainer");
    const breakdownText = document.getElementById("breakdownText");
    const reserveBtn = document.getElementById("reserveBtn");
    
    // Ao clicar no input de datas, alterna a exibi√ß√£o do calend√°rio
    bookingDateInput.addEventListener("click", () => {
      if (datePickerContainer.style.display === "none" || datePickerContainer.style.display === "") {
        datePickerContainer.style.display = "block";
        const today = new Date();
        currentCalendarYear = today.getFullYear();
        currentCalendarMonth = today.getMonth();
        generateCalendar(currentCalendarYear, currentCalendarMonth);
      } else {
        datePickerContainer.style.display = "none";
      }
    });
    
    // Fun√ß√£o para verificar se h√° algum dia bloqueado no intervalo
    function isBlockedInRange(startDate, endDate) {
      // Se endDate < startDate, n√£o faz sentido
      if (endDate < startDate) return false;
      // Percorre cada dia no intervalo e verifica se est√° bloqueado
      let date = new Date(startDate.getTime());
      while (date <= endDate) {
        const y = date.getFullYear();
        const m = String(date.getMonth() + 1).padStart(2, "0");
        const d = String(date.getDate()).padStart(2, "0");
        const ds = `${y}-${m}-${d}`;
        if (bookedDatesGlobal.includes(ds)) {
          return true; // encontrou um bloqueado
        }
        // avan√ßa 1 dia
        date.setDate(date.getDate() + 1);
      }
      return false;
    }
    
    async function generateCalendar(year, month) {
      if (bookedDatesGlobal.length === 0) {
        bookedDatesGlobal = await getBookedDates();
      }
      // Limpa o conte√∫do do container do calend√°rio
      datePickerContainer.innerHTML = "";
      
      // Cria e adiciona a mensagem de estadia m√≠nima
      minNightsMessage = document.createElement("div");
      minNightsMessage.id = "minNightsMessage";
      minNightsMessage.textContent = "A estadia m√≠nima √© 4 noites";
      datePickerContainer.appendChild(minNightsMessage);
      
      // Cabe√ßalho com navega√ß√£o
      const headerDiv = document.createElement("div");
      headerDiv.className = "date-picker-header";
      const prevBtn = document.createElement("button");
      prevBtn.className = "nav-button";
      prevBtn.innerHTML = "&#10094;";
      prevBtn.addEventListener("click", () => {
        const today = new Date();
        if (year > today.getFullYear() || (year === today.getFullYear() && month > today.getMonth())) {
          if (month === 0) {
            month = 11; 
            year--;
          } else {
            month--;
          }
          currentCalendarYear = year; 
          currentCalendarMonth = month;
          generateCalendar(year, month);
        }
      });
      headerDiv.appendChild(prevBtn);
      
      const monthNames = ["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho",
                          "Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];
      const title = document.createElement("span");
      title.textContent = monthNames[month] + " " + year;
      headerDiv.appendChild(title);
      
      const nextBtn = document.createElement("button");
      nextBtn.className = "nav-button";
      nextBtn.innerHTML = "&#10095;";
      nextBtn.addEventListener("click", () => {
        const today = new Date();
        const maxDate = new Date(today.getFullYear(), today.getMonth() + 12, 1);
        const currentDisplayed = new Date(year, month, 1);
        if (currentDisplayed < maxDate) {
          if (month === 11) {
            month = 0; 
            year++;
          } else {
            month++;
          }
          currentCalendarYear = year; 
          currentCalendarMonth = month;
          generateCalendar(year, month);
        }
      });
      headerDiv.appendChild(nextBtn);
      datePickerContainer.appendChild(headerDiv);
      
      // Grid de dias da semana
      const gridDiv = document.createElement("div");
      gridDiv.className = "date-picker-grid";
      const daysOfWeek = ["D","S","T","Q","Q","S","S"];
      daysOfWeek.forEach(d => {
        const cell = document.createElement("div");
        cell.style.fontWeight = "bold";
        cell.textContent = d;
        gridDiv.appendChild(cell);
      });
      
      let firstDay = new Date(year, month, 1);
      let startDay = firstDay.getDay();
      for (let i = 0; i < startDay; i++) {
        gridDiv.appendChild(document.createElement("div"));
      }
      
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      for (let day = 1; day <= daysInMonth; day++) {
        const cell = document.createElement("div");
        cell.className = "date-picker-day";
        cell.textContent = day;
        const dateStr = `${year}-${String(month+1).padStart(2,"0")}-${String(day).padStart(2,"0")}`;
        cell.dataset.date = dateStr;
        
        // Se a data j√° estiver selecionada, permite deselecionar ao clicar
        if (selectedCheckin === dateStr || selectedCheckout === dateStr) {
          cell.classList.add("selected-day");
          cell.addEventListener("click", () => {
            selectedCheckin = null; 
            selectedCheckout = null;
            currentHoveredDate = null;
            generateCalendar(currentCalendarYear, currentCalendarMonth);
            document.querySelector("#bookingDateInput span").textContent = "Selecione datas";
            resumoContainer.style.display = "none";
            breakdownContainer.style.display = "none";
            reserveBtn.style.display = "none";
          });
        }
        // Se for um dia bloqueado
        else if (bookedDatesGlobal.includes(dateStr)) {
          cell.classList.add("disabled-day");
          // pointer-events: none (j√° no CSS) => sem clique
        }
        else {
          // Dia normal
          cell.addEventListener("mouseover", function() {
            if (selectedCheckin && !selectedCheckout) {
              currentHoveredDate = dateStr;
              updateCalendarHighlights();
            }
          });
          cell.addEventListener("mouseout", function() {
            currentHoveredDate = null;
            updateCalendarHighlights();
          });
          cell.addEventListener("click", () => handleDateSelection(dateStr));
        }
        gridDiv.appendChild(cell);
      }
      datePickerContainer.appendChild(gridDiv);
    }
    
    // Verifica se existe algum bloqueio no range e se atende min. 4 noites
    function updateCalendarHighlights() {
      const dayCells = datePickerContainer.querySelectorAll(".date-picker-day");
      if (!selectedCheckin || !currentHoveredDate) {
        dayCells.forEach(cell => cell.classList.remove("hover-range"));
        minNightsMessage.style.display = "none";
        return;
      }
      const checkinDate = new Date(selectedCheckin);
      const hoveredDate = new Date(currentHoveredDate);
      if (hoveredDate < checkinDate) {
        dayCells.forEach(cell => cell.classList.remove("hover-range"));
        minNightsMessage.style.display = "none";
        return;
      }
      // Verifica se h√° bloqueio no intervalo
      const blocked = isBlockedInRange(checkinDate, hoveredDate);
      const potentialNights = (hoveredDate - checkinDate) / (1000 * 3600 * 24);
      
      // Se h√° bloqueio ou se < 4 noites
      if (blocked || potentialNights < 4) {
        dayCells.forEach(cell => cell.classList.remove("hover-range"));
        const hoveredCell = datePickerContainer.querySelector(`[data-date="${currentHoveredDate}"]`);
        if (hoveredCell) {
          let newTop = hoveredCell.offsetTop - hoveredCell.offsetHeight - 5;
          newTop = newTop < 0 ? 0 : newTop;
          minNightsMessage.style.left = hoveredCell.offsetLeft + "px";
          minNightsMessage.style.top = newTop + "px";
          minNightsMessage.style.display = "block";
        }
      } else {
        minNightsMessage.style.display = "none";
        dayCells.forEach(cell => {
          const cellDate = new Date(cell.dataset.date);
          if (cellDate >= checkinDate && cellDate <= hoveredDate) {
            cell.classList.add("hover-range");
          } else {
            cell.classList.remove("hover-range");
          }
        });
      }
    }
    
    function handleDateSelection(dateStr) {
      if (selectedCheckin && !selectedCheckout) {
        const checkinDate = new Date(selectedCheckin);
        const checkoutDate = new Date(dateStr);
        if (checkoutDate <= checkinDate) return;
        
        // Verifica se existe bloqueio no intervalo
        if (isBlockedInRange(checkinDate, checkoutDate)) {
          // n√£o permite concluir
          return;
        }
        const nights = (checkoutDate - checkinDate) / (1000 * 3600 * 24);
        if (nights < 4) {
          // n√£o atinge min. 4 noites
          return;
        }
        selectedCheckout = dateStr;
        datePickerContainer.style.display = "none";
        showResumo();
      } else {
        selectedCheckin = dateStr;
        selectedCheckout = null;
      }
      generateCalendar(currentCalendarYear, currentCalendarMonth);
    }
    
    function calculateNights(checkin, checkout) {
      const cIn = new Date(checkin);
      const cOut = new Date(checkout);
      return (cOut - cIn) / (1000 * 3600 * 24);
    }
    
    /****************************************************
     * RESUMO E BREAKDOWN (Reserva)
     ****************************************************/
    function showResumo() {
      const nights = calculateNights(selectedCheckin, selectedCheckout);
      const baseRate = 120;
      let nightsCost = baseRate * nights;
      const cleaningFee = 50;
      let discount = (nights > 7) ? 0.04 * nightsCost : 0;
      const total = nightsCost - discount + cleaningFee;
      // Exibe as datas numa linha e o total noutra linha
      resumoText.innerHTML = `<p>${formatDate(selectedCheckin)} - ${formatDate(selectedCheckout)}</p>
                              <p>Total: ${total.toFixed(2)}‚Ç¨</p>`;
      resumoContainer.style.display = "block";
      document.querySelector("#bookingDateInput span").textContent = `${formatDate(selectedCheckin)} - ${formatDate(selectedCheckout)}`;
      reserveBtn.style.display = "block";
      toggleDetalhes.textContent = "Ver detalhes";
      breakdownContainer.style.display = "none";
    }
    
    toggleDetalhes.addEventListener("click", () => {
      if (breakdownContainer.style.display === "block") {
        breakdownContainer.style.display = "none";
        toggleDetalhes.textContent = "Ver detalhes";
      } else {
        const nights = calculateNights(selectedCheckin, selectedCheckout);
        const baseRate = 120;
        let nightsCost = baseRate * nights;
        const cleaningFee = 50;
        let discount = (nights > 7) ? 0.04 * nightsCost : 0;
        const total = nightsCost - discount + cleaningFee;
        breakdownText.innerHTML = 
          `<p><strong>Noites:</strong> ${nights} x 120‚Ç¨ = ${nightsCost.toFixed(2)}‚Ç¨</p>` +
          (discount > 0 ? `<p><strong>Desconto semanal:</strong> -${discount.toFixed(2)}‚Ç¨</p>` : "") +
          `<p><strong>Taxa de Limpeza:</strong> 50‚Ç¨</p>
           <hr>
           <p><strong>Total:</strong> ${total.toFixed(2)}‚Ç¨</p>`;
        breakdownContainer.style.display = "block";
        toggleDetalhes.textContent = "Ocultar";
      }
    });
    
    reserveBtn.addEventListener("click", () => {
      alert("Reserva conclu√≠da!\nCheck-in: " + selectedCheckin +
            "\nCheck-out: " + selectedCheckout +
            "\nH√≥spedes: " + document.getElementById("guests").value);
    });
  </script>
</body>
</html>
